/* 学术风预设初值，由 store 覆盖；浮窗高度=视口减上/下按钮行与间距，App.tsx 同步写入。
 * iOS 首进色块成因：首帧 env(safe-area-inset-*) 有时未生效(为 0)，固定栏被状态栏/Home 条遮挡；旋转后 resize 重算即正常。对策：index 首帧从 localStorage 恢复主题、触屏下固定栏用 max(inset, 最小 44/34px) 保底。 */
:root {
  --safe-area-inset-bottom: env(safe-area-inset-bottom, 0px);
  /** 横屏时左右安全区可能一大一小，取较大值使左右按钮视觉对称 */
  --safe-area-inset-h: max(env(safe-area-inset-left, 0px), env(safe-area-inset-right, 0px));
  --float-trigger-row: 44px;
  /** 底部行高 = 与顶部同一行高 + 安全区，不单独写死 */
  --float-trigger-row-bottom: calc(var(--float-trigger-row) + var(--safe-area-inset-bottom));
  /** 顶部/底部按钮离边缘距离，同一变量对称 */
  --float-trigger-inset: 10px;
  --float-panel-gap: 12px;
  --float-panel-max-height: calc(
    100vh - var(--float-trigger-row) - var(--float-panel-gap) - var(--float-trigger-row-bottom)
  );
  --toolbar-btn-opacity: 0.92;
  --bg: #f0f0f0;
  --bg-target: #ffffff;
  --bg-sidebar: #f5f5f5;
  --border: #d8d8d8;
  --text: #1a1a1a;
  --text2: #666666;
  --accent: #2563eb;
  --focus-ring: 0 0 0 2px color-mix(in srgb, var(--accent) 42%, transparent);
  --toolbar-bg: #64748b;
  --toolbar-hover: #334155;
  --toolbar-text: #ffffff;
  --node-fill: #ffffff;
  --node-stroke: #94a3b8;
  --node-text: #1e293b;
  --node-attr-fill: #f8fafc;
  --tensor-fill: #f8fafc;
  --tensor-stroke: #94a3b8;
  --edge-stroke: #94a3b8;
}
@media (pointer: coarse) {
  :root {
    --float-trigger-row: 36px;
    --float-trigger-inset: 6px;
  }
}
[data-theme='dark'] {
  --bg: #18181b;
  --bg-target: #27272a;
  --bg-sidebar: #1f1f23;
  --border: #3f3f46;
  --text: #fafafa;
  --text2: #a1a1aa;
  --accent: #3b82f6;
  --toolbar-bg: #71717a;
  --toolbar-hover: #e4e4e7;
  --toolbar-text: #1a1a1a;
  --node-fill: #27272a;
  --node-stroke: #52525b;
  --node-text: #fafafa;
  --node-attr-fill: #2a2a2e;
  --tensor-fill: #2d2d32;
  --tensor-stroke: #52525b;
  --edge-stroke: #52525b;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}
html {
  height: 100%;
  min-height: 100vh;
  width: 100%;
  min-width: 0;
  overflow: hidden;
  overscroll-behavior: none;
  background: var(--bg);
}
@supports (height: 100dvh) {
  html {
    height: 100dvh;
    min-height: 100dvh;
  }
}
/* body 不覆盖底部安全区，该区域由 html 背景填充，避免系统绘制异色块 */
body {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: env(safe-area-inset-bottom, 0px);
  width: 100%;
  height: 100%;
  min-width: 0;
  min-height: 100vh;
  overflow: hidden;
  overscroll-behavior: none;
  font-family:
    -apple-system, BlinkMacSystemFont, 'Segoe UI', Ubuntu, 'Droid Sans', sans-serif, 'PingFang SC';
  font-size: 12px;
  background: var(--bg);
  color: var(--text);
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
}
/* 触屏/PWA 首帧 safe-area 常为 0，用最小保留使首屏即正确；首帧后脚本触发 resize 促浏览器重算 */
@media (pointer: coarse), (display-mode: standalone) {
  body {
    bottom: max(env(safe-area-inset-bottom, 0px), 44px);
  }
}
#root {
  height: 100%;
  min-height: 100vh;
  width: 100%;
  min-width: 0;
  overflow: hidden;
  overscroll-behavior: none;
}
/* 首屏高度由 100dvh 控制，避免 iOS 首进时脚本视口未稳定导致色块（覆盖上面的 100vh） */
@supports (height: 100dvh) {
  body,
  #root {
    min-height: 100dvh;
  }
}
